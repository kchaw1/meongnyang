<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nmcat.repository.mapper.MgmtABSMapper">
<resultMap id="memberMap" type="Member">
		<result column="no" property="no" />
		<result column="id" property="id" />
		<result column="type" property="type" />
		<result column="pass" property="pass" />
		<result column="category" property="category" />
		<result column="email" property="email" />
		<result column="abs_like_count" property="absLikeCount" />
		<result column="grade_no" property="gradeNo" />
		<result column="image_name" property="imageName" />
		<result column="image_path" property="imagePath" />
		<result column="image_size" property="imageSize" />
		<result column="sign_up_date" property="signUpDate" />
		<result column="login_state" property="loginState" />
		<result column="auth_state" property="authState" />
		<result column="greetings" property="greetings" />
		<result column="point" property="point" />
</resultMap>

<resultMap id="historyMap" type="LoginHistory">
		<result column="login_no" property="loginNo" />
		<result column="login_id" property="loginId" />
		<result column="login_date_time" property="loginDateTime" />
		<result column="logout_date_time" property="logoutDateTime" />
</resultMap>

<resultMap id="comMap" type="CommunityBoard">
		<result column="com_no" property="comNo" />
		<result column="com_title" property="comTitle" />
		<result column="com_writer" property="comWriter" />
		<result column="com_content" property="comContent" />
		<result column="com_category" property="comCategory" />
		<result column="com_rec_cnt" property="comRecCnt" />
		<result column="com_view_cnt" property="comViewCnt" />
		<result column="com_reg_date" property="comRegDate" />
</resultMap>

<resultMap id="careerMap" type="Career">
		<result column="career_no" property="careerNo" />
		<result column="id" property="id" />
		<result column="career_start" property="careerStart" />
		<result column="career_end" property="careerEnd" />
		<result column="career_content" property="careerContent" />
</resultMap>

<resultMap id="licenseMap" type="License">
		<result column="license_no" property="licenseNo" />
		<result column="id" property="id" />
		<result column="lif_sys_name" property="lifSysName" />
		<result column="lif_path" property="lifPath" />
		<result column="lif_ori_name" property="lifOriName" />
		<result column="lif_size" property="lifSize" />
</resultMap>

<resultMap id="commentMap" type="CommunityComment">
		<result column="comc_no" property="comcNo" />
		<result column="comc_writer" property="comcWriter" />
		<result column="com_no" property="comNo" />
		<result column="comc_content" property="comcContent" />
		<result column="comc_reg_date" property="comcRegDate" />
		<result column="comc_ref" property="comcRef" />
		<result column="comc_parent_no" property="comcParentNo" />
</resultMap>

<!-- 전문가 리스트 -->
<select id="selectABSList" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where type = 2 and auth_state = #{authState}
	 order by no asc 
	 limit #{begin}, 10
</select>

<!-- 오름차순 정렬 -->
<select id="selectABSListSortedbyId" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where type = 2 and auth_state = #{authState}
	 order by id asc 
	 limit #{begin}, 10
</select>
<select id="selectABSListSortedbyName" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where type = 2 and auth_state = #{authState}
	 order by name asc 
	 limit #{begin}, 10
</select>
<select id="selectABSListSortedbySignUpDate" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where type = 2 and auth_state = #{authState}
	 order by sign_up_date asc 
	 limit #{begin}, 10
</select>
<select id="selectABSListSortedbyScore" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where type = 2 and auth_state = #{authState}
	 order by score asc 
	 limit #{begin}, 10
</select>
<select id="selectABSListSortedbyPoint" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where type = 2 and auth_state = #{authState}
	 order by point asc 
	 limit #{begin}, 10
</select>
<!-- /정렬 -->
		
<!-- 최근접속일 -->		
<select id="selectRecentLogin" parameterType="string" resultType="LoginHistory">
	select max(login_date_time)
  	  from mn_login_history
 	 where login_id = #{loginId}
</select>	

<!-- 디테일 -->
<select id="selectABSDetail" parameterType="int" resultMap="memberMap">
	select *
	  from mn_member
	 where no = #{no}
</select>

<!-- 작성한 게시글 -->
<select id="selectBoardById" parameterType="string" resultMap="comMap">
	select *
	  from mn_com
	 where com_writer = #{comWriter} 
</select>

<!-- 작성한 코멘트 -->
<select id="selectCommentById" parameterType="string" resultMap="commentMap">
	select *
	  from mn_com_comment
	 where comc_writer = #{comcWriter}
</select>

<!-- 승인 -->
<update id="authApprove" parameterType="int">
	update mn_member
	   set auth_state = 'y'
     where no = #{no}	   
</update>

<!-- 경력조회 -->
<select id="selectCareerById" parameterType="string" resultMap="careerMap">
	select *
	  from mn_member_career
	 where id = #{id}
</select>

<!-- 탈퇴처리 -->
<delete id="deleteMember" parameterType="int">
	delete from mn_member
		  where no = #{no}
</delete>

<!-- 검색 -->
<select id="searchABSByName" parameterType="Member" resultMap="memberMap">
	select *
	  from mn_member
	 where name like CONCAT('%',#{name},'%') and type='2' and auth_state = #{authState}
	 order by no asc 
	 limit #{begin}, 10
</select> 

<!-- 자격증 파일이름 호출 -->
<select id="selectLicenceOriName" parameterType="string" resultMap="licenseMap">
	select *
	  from mn_member_license
	 where id = #{id}  
</select>



</mapper>